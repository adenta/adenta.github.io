<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1 user-scalable=no">

  <title>Indy 500 Family</title>
  <meta name="description" content="What is this?">

  <link type="text/css" rel="stylesheet" href=" /assets/materialize/sass/materialize.css">
  <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
  <link type="text/css" rel="stylesheet" href=" /assets/style.css " media="screen,projection">


  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script  src=" /assets/materialize/js/bin/materialize.js "></script>
  <script  src=" /assets/materialize/js/initial.js"></script>
  <script  src=" /assets/core.js "></script>
  <script  src=" /assets/masonry.js "></script>

  <link rel="canonical" href="http://denta.co/500">
  <link rel="alternate" type="application/rss+xml" title="Andrew Denta" href="http://denta.co /feed.xml ">

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>


  <body class="grey lighten-4">
    <main>
    <header class="site-header">
    <nav>
        <div class="nav-wrapper container">
            <a href="http://denta.co" class="brand-logo">Andrew Denta </a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

            <ul class="right hide-on-med-and-down">
                 
                
<li><a class="page-link" href="/about/">About</a></li>


                         
                
<li><a class="page-link" href="/projects/">Projects</a></li>


                   
                
<li><a class="page-link" href="/tutorials/">Tutorials</a></li>


                  
            </ul>

            <ul class="side-nav" id="mobile-demo">
               
              
<li><a class="page-link" href="/about/">About</a></li>



                       
              
<li><a class="page-link" href="/projects/">Projects</a></li>



                 
              
<li><a class="page-link" href="/tutorials/">Tutorials</a></li>



                
            </ul>
        </div>
    </nav>
</header>


    <div class="container">
      <div class="wrapper">
        <article class="post card-panel" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Indy 500 Family</h1>
    <p class="post-meta"><time datetime="2016-05-29T04:45:31-04:00" itemprop="datePublished">May 29, 2016</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h2 id="what-is-this">What is this?</h2>

<p>The Denta family year after year tries to pick who will win the Indianapolis 500. I was able to get access to the race data API, and decided to make a dashboard about who is currently ‘winning’ in the family. This page will delete itself tomorrow!</p>

<p><strong>Please take this information with a grain of salt.</strong> I wrote this quickly, so it would be of use for as much of the race as possible. <strong>I am not counting extra points that are to be distributed after the race</strong>.</p>

<p>Two extra points are awarded if you correctly predicted:</p>

<ul>
  <li>Leader at 10 laps left wins race?</li>
  <li>Winning driver leads most laps?</li>
  <li>Pole sitter (Hinchcliffe) finishes in top 5?</li>
</ul>

<p>
  Time: <span id="time"> </span>
</p>
<p>
  Current Lap: <span id="lap"></span>
</p>
<p>
  Top Three: <span id="three"></span>
</p>
<p><b>
Score:
</b></p>
<ul id="out" class="collection">

</ul>

<script>

if (!String.prototype.includes) {
  String.prototype.includes = function(search, start) {
    'use strict';
    if (typeof start !== 'number') {
      start = 0;
    }

    if (start + search.length > this.length) {
      return false;
    } else {
      return this.indexOf(search, start) !== -1;
    }
  };
}


var family = [{
  "1": "Munoz",
  "3": "Castroneves",
  "6": "Dixon",
  "Name": "Tuttle"
}, {
  "1": "Pagenaud",
  "3": "Dixon",
  "6": "Montoya",
  "Name": "Andrew"
}, {
  "1": "Daly",
  "3": "Kanaan",
  "6": "Castroneves",
  "Name": "Katie"
}, {
  "1": "Kanaan",
  "3": "Hunter-Reay",
  "6": "Power",
  "Name": "Mitch"
}, {
  "1": "Hildebrand",
  "3": "Montoya",
  "6": "Power",
  "Name": "TeriAnn"
}, {
  "1": "Power",
  "3": "Kanaan",
  "6": "Montoya",
  "Name": "Bee"
}, {
  "1": "Hinchcliffe",
  "3": "Pagenaud",
  "6": "Hunter-Reay",
  "Name": "Lt. Dan"
}, {
  "1": "Castroneves",
  "3": "Hinchcliffe",
  "6": "Hunter-Reay",
  "Name": "Leenie"
}, {
  "1": "Newgarden",
  "3": "Rahal",
  "6": "Dixon",
  "Name": "Jackie"
}];


var topThree = [];

function processResults(d) {
  var scores = [];

  var time = d.timing_results.heartbeat.dateTime;
  document.getElementById('time').innerHTML = time;


  var out = document.getElementById('out');
  out.innerHTML = "";

  var drivers = d.timing_results.Item;
  topThree = [];
  for (var i = 0; i < 3; i++) {
    topThree.push(drivers[i].lastName);
  }

  document.getElementById('lap').innerHTML = drivers[0].laps;
  document.getElementById('three').innerHTML = topThree.join(", ");

  family.forEach(function(e) {
    var score = 0;
    if (topThree.includes(e["1"])) {
      score += 1;
    }
    if (topThree[1] == e["3"] || topThree[0] == e["3"]) {
      score += 3;
    }

    if (topThree[0] == e["6"]) {
      score += 6;
    }
    scores.push({
      "name": e.Name,
      "score": score
    });
  });

  scores.sort(function(a, b) {
    return b.score - a.score;
  });
  console.log(scores);
  scores.forEach(function(e) {
    out.innerHTML += "<li class='collection-item'>" + "<b>" + e.score + "</b> " + e.name + "</li>";
  });

};
$(document).ready(function() {

  var url = 'http://racecontrol.indycar.com/xml/timingscoring.json';
  //var url = 'http://dev.ims.com/xml/timingscoring.json';
  setInterval(function() {
    $.ajax({
      type: 'GET',
      url: url,
      async: false,
      jsonpCallback: 'jsonCallback',
      contentType: "application/json",
      dataType: 'jsonp',
      success: processResults
    });

  }, 5000);

});


</script>


  </div>

</article>

      </div>
    </div>
  </main>
    <footer class="page-footer ">

  <div class="container row">
    <a class="white-text"href="mailto:andrew.denta@gmail.com">andrew.denta@gmail.com</a>



  </div>
  <div class="footer-copyright">
    <div class="container">
      ©2016 
    </div>
  </div>
</footer>


  </body>

</html>
